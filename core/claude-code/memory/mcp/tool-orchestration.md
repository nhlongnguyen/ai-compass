# MCP Tool Orchestration

## Research-First Protocol

### Mandatory Research Triggers
- External library detected → Context7 lookup REQUIRED
- New component request → Magic search or existing pattern
- API integration → WebSearch for official docs
- Unknown pattern → Sequential thinking + research
- Confidence < 90% → Implementation BLOCKED until research complete

## Tool Selection Rules

### Context7 Triggers
- External library mentioned
- Documentation request
- API integration
- Framework questions

### Sequential Triggers
- Complex analysis needed
- Step-by-step breakdown required
- Architecture design
- Root cause analysis

### Magic Triggers
- UI component request
- Component generation
- Interface design
- Visual element creation

### Puppeteer Triggers
- Browser testing needed
- E2E validation
- Visual regression testing
- Performance testing

## Confidence Integration

### Tool Selection by Confidence
- **≥90%**: Proceed with appropriate tools based on context
- **70-89%**: Use research tools (Context7, Sequential) to increase confidence
- **<70%**: Research-first protocol mandatory before implementation

### Confidence Bonuses from Tools
- Context7 Documentation: +10% when external library involved
- Sequential Analysis: +15% for complex multi-step problems
- Magic UI Generation: +5% for component creation tasks
- Puppeteer Validation: +10% for browser-based verification

## Token Economics

### Budget Management
- Light MCP: 100-500 tokens (simple lookups)
- Medium MCP: 500-2K tokens (complex analysis)
- Heavy MCP: 2K-10K tokens (comprehensive research)

### Efficiency Rules
- Quick tasks → Context7 only
- Architecture decisions → Sequential primary
- UI requirements → Magic generation
- Everything else → Native tools preferred